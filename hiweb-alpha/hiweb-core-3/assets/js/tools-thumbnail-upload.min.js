var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var h=a[e];if(d.call(b,h,e,a))return{i:e,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in b||(b[e]={});b=b[e]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
jQuery(document).ready(function(a){var d={init:function(){a(".wp-list-table tbody tr[id]").each(function(){var b=a(this),c=b.find(".thumb_hw_upload_zone");if(null!=b.attr("id").match(/^post-/)){b=b.attr("id").replace("post-","");var f="post"}else b=b.attr("id").replace("tag-",""),f="taxonomy";d._make_events(c,b,f);d._make_upload_zone(c,b,f)});var b=!1,c=-1;a("html, .thumb_hw_upload_zone").bind("dragenter",function(){a(".thumb_hw_upload_zone").addClass("global-dragover");b=!0}).bind("dragover",function(){b=
!0}).bind("dragleave",function(e){b=!1;clearTimeout(c);c=setTimeout(function(){b||a(".thumb_hw_upload_zone").removeClass("global-dragover")},200)})},open_media:function(b,c,e){var d=wp.media({title:"\u0412\u044b\u0431\u043e\u0440 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",library:{type:"image"},multiple:!1,button:{text:"Select Image"}});d.on("select",function(){var f=d.state().get("selection").first().toJSON();if(f.hasOwnProperty("id")&&f.hasOwnProperty("type")&&"image"===
f.type&&f.hasOwnProperty("sizes")){var h=["thumbnail","medium","full"],g=!1,k;for(k in f.sizes)if(-1<h.indexOf(k)){g=f.sizes[k].url;break}!1===g&&f.hasOwnProperty("url")&&(g=f.url);!1===g?alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043f\u043e\u0438\u0441\u043a\u0435 URL"):(b.find("[data-img]").css("background-image","url("+g+")"),b.attr("data-has-thumbnail","1").attr("data-is-process","1"),a.ajax({url:ajaxurl+"?action=hiweb-tools-thumbnail-upload-post-type-set",type:"post",dataType:"json",
data:{do:"upload",post_id:c,thumbnail_id:f.id,type:e},success:function(a){b.attr("data-is-process","0");a.success?b.attr("data-has-thumbnail","1"):(alert(a.data),console.warn(a))},error:function(a){b.attr("data-is-process","0");console.warn(a)}}))}else alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u0431\u043e\u0440\u0430 \u0444\u0430\u0439\u043b\u0430")});d.open()},_make_events:function(b,c,e){a(b).find("[data-ctrl-btn]").on("click",function(){switch(a(this).attr("data-ctrl-btn")){case "upload":b.trigger("click");
break;case "media":d.open_media(b,c,e);break;case "remove":d._click_remove(b,c,e)}})},_make_upload_zone:function(b,c,d){if("function"===typeof Dropzone){var e=a(b).attr("id"),f=!1,l=-1;0!==jQuery("#"+e).length&&new Dropzone("#"+e,{url:ajaxurl+"?action=hiweb-tools-thumbnail-upload-post-type-uploading",headers:{postid:c,posttype:d},maxFilesize:20,filesizeBase:1024,previewsContainer:!1,type:"post",dataType:"json",data:{do:"upload",post_id:c},dragenter:function(){f=!0;b.addClass("dragover")},dragover:function(){f=
!0},dragleave:function(){f=!1;clearTimeout(l);l=setTimeout(function(){f||b.removeClass("dragover")},200)},addedfile:function(c){b.removeClass("dragover");b.attr("data-is-process","1");a(".global-dragover").removeClass("global-dragover")},complete:function(c){b.attr("data-is-process","0");b.removeClass("dragover");a(".global-dragover").removeClass("global-dragover");c=a.parseJSON(c.xhr.response);"object"==typeof c?0==c.success?alert("\u0432 \u0445\u043e\u0434\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430: "+
c.data):(b.attr("data-has-thumbnail","1"),b.find("[data-img]").css("background-image","url("+c.data+")")):(alert("\u0412 \u0445\u043e\u0434\u0435 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430: 1"),console.warn(c))}})}},_click_remove:function(b,c,d){b.removeClass("dragover");b.attr("data-is-process","1");a.ajax({url:ajaxurl+"?action=hiweb-tools-thumbnail-upload-post-type-remove",type:"post",dataType:"json",
data:{do:"upload",post_id:c},success:function(a){b.attr("data-is-process","0");a.success?b.attr("data-has-thumbnail","0"):(console.warn(a),alert(a.data))},error:function(a){b.attr("data-is-process","0");console.warn(a)}})}};d.init()});
