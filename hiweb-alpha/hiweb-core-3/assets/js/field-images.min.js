var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var e=a.length,d=0;d<e;d++){var f=a[d];if(c.call(b,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var d=a[e];d in b||(b[d]={});b=b[d]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
var hiweb_field_images={selector_root:".hiweb-field-images",init:function(){jQuery("body").on("click",'.hiweb-field-images [data-ctrl-sub="left"], .hiweb-field-images [data-ctrl-sub="right"]',function(a){a.preventDefault();hiweb_field_images.event_click_add(hiweb_field_images.get_root(this),"right"===jQuery(this).attr("data-ctrl-sub"))});jQuery("body").on("click",".hiweb-field-images [data-click-remove]",function(a){a.preventDefault();hiweb_field_images.event_click_remove(jQuery(this).closest("[data-image-id]"))});
jQuery("body").on("click",".hiweb-field-images [data-click-reverse]",function(a){a.preventDefault();hiweb_field_images.event_click_reverse(this)});jQuery("body").on("click",".hiweb-field-images [data-click-random]",function(a){a.preventDefault();hiweb_field_images.event_click_random(this)});jQuery("body").on("click",".hiweb-field-images [data-click-clear]",function(a){a.preventDefault();hiweb_field_images.event_click_clear(this)});jQuery("body").on("click",".hiweb-field-images [data-click-add]",function(a){a.preventDefault();
hiweb_field_images.event_click_add(hiweb_field_images.get_root(this),!0)});jQuery("body").on("click",".hiweb-field-images [data-click-edit]",function(a){a.preventDefault();hiweb_field_images.event_click_edit(this)});hiweb_field_images.make_sortable();hiweb_field_images.make_dropdown()},shuffleElements:function(a){var c,b=a.length,e=a.parent(),d=[];for(c=0;c<b;c++)d.push(c);for(c=0;c<b;c++){var f=Math.random()*b|0;var g=Math.random()*b|0;var h=d[f];d[f]=d[g];d[g]=h}a.detach();for(c=0;c<b;c++)e.append(a.eq(d[c]))},
get_root:function(a){return jQuery(a).closest(".hiweb-field-images")},get_source:function(a){return hiweb_field_images.get_root(a).find("[data-source]")},get_list_root:function(a){return hiweb_field_images.get_root(a).find("[data-images-wrap]")},get_list_images:function(a){return hiweb_field_images.get_list_root(a).find("> [data-image-id]")},make_dropdown:function(){jQuery(hiweb_field_images.selector_root+" .dropdown").dropdown({action:"hide"})},make_sortable:function(){jQuery(".hiweb-field-images [data-images-wrap]").sortable({distance:5,
cursor:"move",handle:".overlay, .button",helper:"original",revert:!0})},event_click_add:function(a,c){var b=wp.media({title:"\u0412\u044b\u0431\u043e\u0440 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f",library:{type:"image"},multiple:!0,button:{text:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0444\u0430\u0439\u043b\u044b"}});b.on("select",function(){b.state().get("selection").map(function(b){hiweb_field_images.select_image(a,c,b.toJSON())});hiweb_field_images.make_sortable()});
b.open()},select_image:function(a,c,b){switch("object"){case typeof b.sizes.medium:var e=b.sizes.medium.url;break;case typeof b.sizes.large:e=b.sizes.large.url;break;case typeof b.sizes.thumbnail:e=b.sizes.thumbnail.url;break;case typeof b.sizes.full:e=b.sizes.full.url;break;default:e=!1}var d=hiweb_field_images.get_source(a).clone();d.find("img").attr("src",e);d.removeAttr("data-source").attr("data-image-id",b);e=d.find("input");e.val(b.id).attr("name",e.attr("data-name")).removeAttr("data-name");
d.attr("id",a.attr("data-id"));d.attr("data-tooltip",b.filename);c?hiweb_field_images.get_list_root(a).append(d):hiweb_field_images.get_list_root(a).prepend(d);c=hiweb_field_images.get_list_root(a).find("> li").length-1;a.attr("data-images-count",c);a.find("[data-images-count]").html(c)},event_click_edit:function(a){a=jQuery(a).closest("[data-image-id]");var c=a.attr("data-image-id"),b=wp.media({title:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0444\u0430\u0439\u043b\u0430",multiple:!1,
button:{text:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0444\u0430\u0439\u043b"},library:{type:"image"}});b.on("open",function(){var a=b.state().get("selection");attachment=wp.media.attachment(c);attachment.fetch();a.add(attachment?[attachment]:[])});b.on("select",function(){b.state().get("selection").map(function(a){a.toJSON()})});b.open()},event_click_remove:function(a){jQuery(a).hide("slow",function(){jQuery(this).remove();hiweb_field_images.refresh_view(hiweb_field_images.get_root(this))})},
event_click_reverse:function(a){var c=hiweb_field_images.get_list_root(a);c.children().each(function(a,e){c.prepend(e)})},event_click_random:function(a){a=hiweb_field_images.get_list_root(a);hiweb_field_images.shuffleElements(a.find("li[data-image-id]"))},event_click_clear:function(a){confirm("Remove all images?")&&(hiweb_field_images.get_list_images(a).each(function(){hiweb_field_images.event_click_remove(this)}),a=hiweb_field_images.get_root(a),a.attr("data-images-count",0),a.find("[data-images-count]").attr("data-images-count",
0))},refresh_view:function(a){}};jQuery(document).ready(hiweb_field_images.init);
