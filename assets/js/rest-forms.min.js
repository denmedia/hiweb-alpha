var hiweb_theme_widget_forms={form_root_seletor:".hiweb-theme-widget-form",wrap_root_selector:"",status_root_selector:".hiweb-theme-widget-form-status",recaptcha_local_selector:'input[name="recaptcha-token"]',init:function(){var a=$(hiweb_theme_widget_forms.form_root_seletor);a.each(function(){$(this).find('button[type="submit"]').removeAttr("disabled");hiweb_theme_widget_forms.make($(this))})},make:function(a){var b=a.find('input[name="recaptcha-token"]').length>0;a.on("keyup change","[name]",function(){$(this).removeClass("require-error").parent().removeClass("require-error").parent().removeClass("require-error")});a.on("submit",function(d){$(this).removeClass("require-error").parent().removeClass("require-error").parent().removeClass("require-error");d.preventDefault();hiweb_theme_widget_forms.set_status(a,"wait");if(b){hiweb_theme_widget_forms.recapthca_get_token(a,function(){hiweb_theme_widget_forms.submit(a)})}else{hiweb_theme_widget_forms.submit(a)}});a.on("click tap","[data-form-status-close]",function(d){d.preventDefault();hiweb_theme_widget_forms.set_status(a,"")});if(typeof a.find("[data-input-mask]").mask==="function"){var c=a.find("[data-input-mask]");c.mask(c.data("input-mask"))}},recapthca_get_token:function(b,c){var a=b.find(hiweb_theme_widget_forms.recaptcha_local_selector);if(a.length>0){grecaptcha.execute(a.data("key")).then(function(d){a.val(d);if(typeof c==="function"){c(b,a)}})}},set_status:function(a,c,d){var b=a.find(hiweb_theme_widget_forms.status_root_selector);if(!b.is("[data-wait-message]")){b.attr("data-wait-message",b.find(".message").html())}else{b.find(".message").html(b.data("wait-message"))}if(!c){c=""}a.attr("data-status",c);if(d){b.find(".message").html(d)}},submit:function(a){a.ajaxSubmit({dataType:"json",success:function(b){if(!b.hasOwnProperty("success")){hiweb_theme_widget_forms.set_status(a,"error","Сервер вернул не верные данные")}else{hiweb_theme_widget_forms.set_status(a,b.status,b.message);if(b.status==="success"){a.trigger("reset");setTimeout(function(){$.fancybox.close(true);hiweb_theme_widget_forms.set_status(a,"")},1500)}if(b.hasOwnProperty("error_inputs")){for(var d in b.error_inputs){var c=b.error_inputs[d];a.find('[name="'+c+'"]').addClass("require-error").parent().addClass("require-error").parent().addClass("require-error")}}}},error:function(b){console.error(b);hiweb_theme_widget_forms.set_status(a,"error","Неизвестная ошибка, попробуйте снова")}})}};jQuery(document).ready(hiweb_theme_widget_forms.init);